<script>
  const apiKey = "3ade810499876bb5672f40e54960e6a2";
  const id = new URLSearchParams(location.search).get("id");

  const titleEl = document.getElementById("movieTitle");
  const videoFrame = document.getElementById("videoFrame");
  const fullscreenBtn = document.getElementById("fullscreenBtn");
  const videoBox = document.getElementById("videoBox");

  if (id) {
    fetch(`https://api.themoviedb.org/3/movie/${id}?api_key=${apiKey}`)
      .then(res => res.json())
      .then(data => {
        titleEl.textContent = data.title || "Unknown Movie";
        videoFrame.src = `https://vidsrc.to/embed/movie/${id}`;
      })
      .catch(() => {
        titleEl.textContent = "Failed to load movie info.";
      });
  } else {
    titleEl.textContent = "No movie ID provided.";
  }

  // Fullscreen toggle
  fullscreenBtn.onclick = () => {
    const elem = videoBox;

    if (
      document.fullscreenElement ||
      document.webkitFullscreenElement ||
      document.mozFullScreenElement ||
      document.msFullscreenElement
    ) {
      document.exitFullscreen?.();
      document.webkitExitFullscreen?.();
      document.mozCancelFullScreen?.();
      document.msExitFullscreen?.();
    } else {
      elem.requestFullscreen?.();
      elem.webkitRequestFullscreen?.();
      elem.mozRequestFullScreen?.();
      elem.msRequestFullscreen?.();
    }
  };

  // Auto-hide fullscreen button after 3.5 seconds
  let hideTimeout;

  const showControls = () => {
    fullscreenBtn.classList.remove("hidden");
    clearTimeout(hideTimeout);
    hideTimeout = setTimeout(() => {
      fullscreenBtn.classList.add("hidden");
    }, 3500);
  };

  // Desktop & mobile input detection
  document.addEventListener("mousemove", showControls);   // mouse movement
  document.addEventListener("touchstart", showControls); // touch on mobile
  document.addEventListener("keydown", showControls);    // keyboard input

  showControls(); // show initially on page load
</script>
